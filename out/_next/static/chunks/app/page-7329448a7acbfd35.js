(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4635:(e,t,n)=>{Promise.resolve().then(n.bind(n,7906))},7906:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var o=n(5155),r=n(2115);function s(){let e=Math.floor(2*Math.random())+1,[t,n]=(0,r.useState)([{role:"system",content:'\nYou are a helpful assistant collecting info for home window services.\n\nAsk the user for the following:\n- First name\n- Last name\n- Type of help (options = true, options_values = repair, install, replace)\n- Number of windows (options = true, options_values = 1, 20, 30, 40)\n- Street address\n- ZIP code\n- Email\n- Phone\n\n\nFor "Type of help" and "Number of windows" questions, ask the question but, as well send a JSON along with the question, example:\neXAMP"What type of help do you need with your windows? Here are your options:\n[{\n  "options": true,\n  "options_values": ["repair", "install", "replace"]\n}]"\n\nAsk **one question at a time**, never multiple. \nMake sure the answers provided are validated( ask for user to correct if you see there is a bigger mistake, don\'t correct small typos).\n\nBe friendly and confirm info when done.\nAdd a final message that a phone call will soon be made, and nudge the user to pick up the phone to get the best deal.\nFeel free to use emojis that are relevant to the message being sent to user to make it more friendly.\nSeparate messages with new lines to make it more readable.\nBold this words : first name, name, last name, ZIP... So user can see them more clearly.\nHighlight keywords in the questions, example : How many windows? Whats your name? What is your last name? ( name, windows and last name should be bolded).\n\nReturn new line breaks as "/\n" and wrap bold text with bold html tag. \nReturn output as html.\nWhen you have all the info, respond with a summary message and include br HTML tags to show the user collected info on new lines and include this JSON at the end:\n\nAfter you collect all 8 items, return:\n1. A natural language confirmation message\n2. A JSON block containing all answers and a "done": true flag\n\nFormat:\n\nThank you for providing all the information! Here\'s a summary:\n\n- **First Name**: ...\n- **Last Name**: ...\n- ...\n\n```json\n{\n  "done": true,\n  "firstName": "...",\n  "lastName": "...",\n  "typeOfHelp": "...",\n  "numberOfWindows": ...,\n  "address": "...",\n  "zipCode": "...",\n  "email": "...",\n  "phone": "..."\n}\n'},{role:"assistant",content:["Welcome! \uD83D\uDE0A To begin, could you please share your first name?","Hi there! \uD83D\uDC4B May I have your first name to begin our conversation?","Welcome! \uD83D\uDE0A May I ask for your first name to begin?"][e]}]),[s,i]=(0,r.useState)(""),[u,d]=(0,r.useState)(!1),[c,m]=(0,r.useState)(!1),[h,p]=(0,r.useState)([]),[f,y]=(0,r.useState)(!1),g=(0,r.useRef)(null),w=(0,r.useRef)(null),[b,x]=(0,r.useState)(null);(0,r.useEffect)(()=>{x(Math.floor(5*Math.random())+2)},[]);let[v,S]=(0,r.useState)(0),[j,k]=(0,r.useState)([]);t[t.length-1];let I=[[{role:"user",content:"How much does it cost to replace 3 windows?"},{role:"assistant",content:"That depends on the size and type — I can help you!"}],[{role:"user",content:"Do you offer bay window installation?"},{role:"assistant",content:"Yes we do! Would you like a free quote?"}],[{role:"user",content:"Can I book a consultation online?"},{role:"assistant",content:"Of course! I’ll help you schedule one now."}],[{role:"user",content:"What’s your turnaround time for installation?"},{role:"assistant",content:"Usually 5–7 days after approval."}],[{role:"user",content:"Do you install triple-glazed windows?"},{role:"assistant",content:"Yes — they’re great for insulation!"}]];(0,r.useEffect)(()=>{c||f||!g.current||g.current.focus()},[c,f]),(0,r.useEffect)(()=>{if(!f)return;let e=[...I].sort(()=>Math.random()-.5).flat(),t=0,n=setInterval(()=>{if(t>=e.length)return void clearInterval(n);let o=e[t];k(e=>[...e,o]),t++},1500);return()=>clearInterval(n)},[f]),(0,r.useEffect)(()=>{w.current&&w.current.scrollIntoView({behavior:"smooth"})},[t]),(0,r.useEffect)(()=>{let e=setTimeout(()=>{y(!1),k([])},9e3);return()=>clearTimeout(e)},[]),(0,r.useEffect)(()=>{if(!f)return;let e=setInterval(()=>{S(t=>t>=100?(clearInterval(e),100):t+1)},95);return()=>clearInterval(e)},[f]);let N=async function(e){var o,r,l;let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.preventDefault();let c=null!=u?u:s;if(!c.trim())return;let h=[...t,{role:"user",content:c}];n(h),i(""),m(!0);let f=await fetch("http://localhost:8888/remodelmatchdb/public/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:h,key:"eyJpdiI6IndYdXBUOUdsekh6Z0owcUxBVmI5K0E9PSIsInZhbHVlIjoiOHZTOTZKQ2ZhYm9tbzIyVG9ZbERZUzAxN0lzWVJWTmswaWN3Z0llaXJ5K1p6N2Z5QmhQSU9aM0wwdVkvOVEvMCIsIm1hYyI6IjY4ZGY0ODVjNDljODFmNjZlYWE2NjU1NTk0ZDY4ZDQ5OWYyZWZhZWQ5YzQzODAyYWFiNDlhMjU1MzllMTZkZjkiLCJ0YWciOiIifQ=="})}),y=(await f.json()).reply,g=!1;y.match(/```json\s*{[^}]*"done"\s*:\s*true[^}]*}\s*```/i)&&(g=!0);let{cleanedReply:w,objectFromApi:b}=a(y),x=Array.isArray(b)&&(null==(o=b[0])?void 0:o.options)===!0,v=!0===x&&(null==(r=b[0])?void 0:r.options_values);x?p((null==(l=b[0])?void 0:l.options_values)||[]):p([]),console.log(x,v),console.log(b),n([...h,{role:"assistant",content:w}]),d(g),m(!1)},O=async e=>{await N({preventDefault:()=>{}},e)};return(0,o.jsx)("main",{style:{maxWidth:600,margin:"2rem auto",padding:"1rem",textAlign:"center"},children:f?(0,o.jsxs)("div",{style:{paddingTop:"3rem"},children:[(0,o.jsx)("h2",{style:{fontSize:25},children:(0,o.jsxs)("strong",{children:["⏳ ",b," people are in the line in front of you..."]})}),(0,o.jsx)("p",{style:{fontSize:20},children:"Waiting for Assistant to free up... "}),(0,o.jsx)("div",{style:{height:"10px",width:"100%",background:"#eee",borderRadius:"4px",overflow:"hidden",margin:"1.5rem 0"},children:(0,o.jsx)("div",{style:{height:"100%",width:"".concat(v,"%"),backgroundColor:"#007bff",transition:"width 0.05s linear"}})}),(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginTop:"1.5rem"},children:j.map((e,t)=>(0,o.jsxs)("p",{className:"chatTextMessage",style:{alignSelf:"user"===e.role?"flex-end":"flex-start",backgroundColor:"user"===e.role?"#DCF8C6":"#F1F0F0",color:"#000",padding:"0.5rem 0.75rem",borderRadius:"16px",maxWidth:"80%",whiteSpace:"pre-wrap",fontSize:"1rem",filter:"blur(0.5px)",opacity:.6,animation:"user"===e.role?"slideInRight 0.3s ease-out":"slideInLeft 0.3s ease-out"},children:[(0,o.jsxs)("strong",{children:["user"===e.role?"You":"Assistant",":"]})," ",e.content]},t))})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h1",{children:"\uD83C\uDFE0 Home Repair Assistant"}),(0,o.jsx)("br",{}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1rem"},children:[t.filter(e=>"system"!==e.role).map((e,t)=>(0,o.jsxs)("p",{className:"chatTextMessage",style:{alignSelf:"user"===e.role?"flex-end":"flex-start",backgroundColor:"user"===e.role?"#DCF8C6":"#F1F0F0",color:"#000",padding:"0.5rem 0.75rem",borderRadius:"16px",maxWidth:"80%",whiteSpace:"pre-wrap",fontSize:"1rem"},children:[(0,o.jsxs)("strong",{children:["user"===e.role?"You":"Assistant",":"]})," ",(0,o.jsx)("span",{dangerouslySetInnerHTML:{__html:l(e.content)}})]},t)),(0,o.jsx)("div",{ref:w})]}),h.length>0&&(0,o.jsx)("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem",flexWrap:"wrap"},children:h.map((e,t)=>(0,o.jsx)("button",{onClick:()=>O(e),style:{padding:"0.5rem 1rem",backgroundColor:"#007bff",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem"},children:e},t))}),(0,o.jsx)("form",{onSubmit:N,children:(0,o.jsx)("input",{ref:g,value:s,onChange:e=>i(e.target.value),placeholder:c?"Waiting for Assistant...":"Type your answer...",className:"border-2",disabled:c||u,style:{width:"100%",padding:"0.5rem",fontSize:"1rem",borderRadius:"0.5rem",borderColor:"#c8b5b5"}})})]})})}let a=e=>{let t=null,n=e,o=e.match(/```json\s*([\s\S]*?)\s*```/i);if(o){var r;let e=null==(r=o[1])?void 0:r.trim();if(e)try{t=JSON.parse(e)}catch(e){console.error("Failed to parse JSON from code block:",e.message)}else console.warn("JSON block found, but it was empty.");n=n.replace(o[0],"").trim()}else{n=n.replace(/```json|```/gi,"").trim();let o=e.match(/(\{[\s\S]*\}|\[[\s\S]*\])/);if(o&&o[0]){try{t=JSON.parse(o[0])}catch(e){console.error("Failed to parse loose JSON:",e.message)}n=n.replace(o[0],"").trim()}}return{cleanedReply:n,objectFromApi:t}},l=e=>e?e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"):e}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(4635)),_N_E=e.O()}]);