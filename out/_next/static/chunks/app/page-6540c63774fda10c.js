(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4635:(e,n,t)=>{Promise.resolve().then(t.bind(t,7906))},7906:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>r});var s=t(5155),o=t(2115);function r(){let[e,n]=(0,o.useState)([{role:"system",content:'\nYou are a helpful assistant collecting info for home window services.\n\nAsk the user for the following:\n- First name\n- Last name\n- Type of help (options = true, options_values = repair, install, replace)\n- Number of windows (options = true, options_values = 1, 20, 30, 40)\n- Street address\n- ZIP code\n- Email\n- Phone\n\n\nFor "Type of help" and "Number of windows" questions, ask the question but, as well send a JSON along with the question, example:\neXAMP"What type of help do you need with your windows? Here are your options:\n[{\n  "options": true,\n  "options_values": ["repair", "install", "replace"]\n}]"\n\nAsk **one question at a time**, never multiple. \nMake sure the answers provided are validated( ask for user to correct if you see there is a bigger mistake, don\'t correct small typos).\n\nBe friendly and confirm info when done.\nAdd a final message that a phone call will soon be made, and nudge the user to pick up the phone to get the best deal.\nFeel free to use emojis that are relevant to the message being sent to user to make it more friendly.\nSeparate messages with new lines to make it more readable.\nBold this words : first name, name, last name, ZIP... So user can see them more clearly.\nHighlight keywords in the questions, example : How many windows? Whats your name? What is your last name? ( name, windows and last name should be bolded).\n\nReturn new line breaks as "/\n" and wrap bold text with bold html tag. \nReturn output as html.\nWhen you have all the info, respond with a summary message and include br HTML tags to show the user collected info on new lines and include this JSON at the end:\n\nAfter you collect all 8 items, return:\n1. A natural language confirmation message\n2. A JSON block containing all answers and a "done": true flag\n\nFormat:\n\nThank you for providing all the information! Here\'s a summary:\n\n- **First Name**: ...\n- **Last Name**: ...\n- ...\n\n```json\n{\n  "done": true,\n  "firstName": "...",\n  "lastName": "...",\n  "typeOfHelp": "...",\n  "numberOfWindows": ...,\n  "address": "...",\n  "zipCode": "...",\n  "email": "...",\n  "phone": "..."\n}\n'},{role:"assistant",content:"Hi there! \uD83D\uDC4B May I have your first name?"}]),[t,r]=(0,o.useState)(""),[i,u]=(0,o.useState)(!1),[d,m]=(0,o.useState)(!1),[c,h]=(0,o.useState)([]),p=(0,o.useRef)(null),f=(0,o.useRef)(null);e[e.length-1],(0,o.useEffect)(()=>{!d&&p.current&&p.current.focus()},[d]),(0,o.useEffect)(()=>{f.current&&f.current.scrollIntoView({behavior:"smooth"})},[e]);let g=async function(s){var o,l,i;let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;s.preventDefault();let c=null!=d?d:t;if(!c.trim())return;let p=[...e,{role:"user",content:c}];n(p),r(""),m(!0);let f=await fetch("http://localhost:8888/remodelmatchdb/public/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:p})}),g=(await f.json()).reply,y=!1;g.match(/```json\s*{[^}]*"done"\s*:\s*true[^}]*}\s*```/i)&&(y=!0);let{cleanedReply:w,objectFromApi:b}=a(g),v=Array.isArray(b)&&(null==(o=b[0])?void 0:o.options)===!0,S=!0===v&&(null==(l=b[0])?void 0:l.options_values);v?h((null==(i=b[0])?void 0:i.options_values)||[]):h([]),console.log(v,S),console.log(b),n([...p,{role:"assistant",content:w}]),u(y),m(!1)},y=async e=>{await g({preventDefault:()=>{}},e)};return(0,s.jsxs)("main",{style:{maxWidth:600,margin:"2rem auto",padding:"1rem"},children:[(0,s.jsx)("h1",{children:"\uD83C\uDFE0 Home Repair Helper"}),(0,s.jsx)("br",{}),(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1rem"},children:[e.filter(e=>"system"!==e.role).map((e,n)=>(0,s.jsxs)("p",{style:{alignSelf:"user"===e.role?"flex-end":"flex-start",backgroundColor:"user"===e.role?"#DCF8C6":"#F1F0F0",color:"#000",padding:"0.5rem 0.75rem",borderRadius:"16px",maxWidth:"80%",whiteSpace:"pre-wrap",fontSize:"1rem"},children:[(0,s.jsxs)("strong",{children:["user"===e.role?"You":"Assistant",":"]})," ",(0,s.jsx)("span",{dangerouslySetInnerHTML:{__html:l(e.content)}})]},n)),(0,s.jsx)("div",{ref:f})]}),c.length>0&&(0,s.jsx)("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem",flexWrap:"wrap"},children:c.map((e,n)=>(0,s.jsx)("button",{onClick:()=>y(e),style:{padding:"0.5rem 1rem",backgroundColor:"#007bff",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem"},children:e},n))}),(0,s.jsx)("form",{onSubmit:g,children:(0,s.jsx)("input",{ref:p,value:t,onChange:e=>r(e.target.value),placeholder:d?"Waiting for Assistant...":"Type your answer...",className:"border-2 border-black",disabled:d||i,style:{width:"100%",padding:"0.5rem",fontSize:"1rem"}})})]})}let a=e=>{let n=null,t=e,s=e.match(/```json\s*([\s\S]*?)\s*```/i);if(s){var o;let e=null==(o=s[1])?void 0:o.trim();if(e)try{n=JSON.parse(e)}catch(e){console.error("Failed to parse JSON from code block:",e.message)}else console.warn("JSON block found, but it was empty.");t=t.replace(s[0],"").trim()}else{t=t.replace(/```json|```/gi,"").trim();let s=e.match(/(\{[\s\S]*\}|\[[\s\S]*\])/);if(s&&s[0]){try{n=JSON.parse(s[0])}catch(e){console.error("Failed to parse loose JSON:",e.message)}t=t.replace(s[0],"").trim()}}return{cleanedReply:t,objectFromApi:n}},l=e=>e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}},e=>{var n=n=>e(e.s=n);e.O(0,[441,684,358],()=>n(4635)),_N_E=e.O()}]);